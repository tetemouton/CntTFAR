Bin.reference.tbl <- rbind(tmp.bet.sz, tmp.skj.sz, tmp.yft.sz)
write.csv(Bin.reference.tbl, paste0(base.dir, "Data/Bin.reference.tbl.csv"), row.names = FALSE)
Bin.reference.tbl <- left_join(Bin.reference.tbl, prc.bins, by = c("Bin","spp"))
N.len %<>% mutate(spp = tolower(sp_id))
N.len <- left_join(N.len, Bin.reference.tbl, by=c("len","spp")) %>%
mutate(Species = recode(spp, bet = "Bigeye", skj = "Skipjack", yft = "Yellowfin"), Twgt = N.cor * wgt)
all.comb <- expand.grid(EEZ = keep.ez, Species = c("Bigeye","Skipjack","Yellowfin"))
cl.len <- N.len %>% filter(between(yy, fst.yr, last.yr), EEZ %in% keep.ez)
cl.len <- left_join(cl.len, FADcls, by = c("yy","mm"))
cl.len.gp <- cl.len %>% filter(SchID == "ASS", Status == "Open") %>% group_by(Species, EEZ, Bin) %>%
summarise(Nfish = sum(N.cor), Wfish = sum(Twgt), Price = mean(Price)) %>%
mutate(Pfish = Nfish / sum(Nfish), Pwgt = Wfish / sum(Wfish))
sml.bin <- cl.len.gp %>% filter(Bin %in% 1:3) %>% group_by(Species, EEZ) %>% summarise(Nfish = sum(Nfish), Pfish = sum(Pfish), Pwgt = sum(Pwgt))
sml.bin <- left_join(all.comb, sml.bin, by = c("EEZ","Species"))
windows(3000,3000)
pl <- ggplot(cl.len.gp, aes(x = EEZ, y = Pfish, fill = factor(Bin))) + geom_bar(stat = "identity", position = "stack") +
facet_wrap(~ Species, ncol = 1) + labs(fill = "Size bin")
print(pl)
dev.off()
windows(3000,3000)
pl <- ggplot(cl.len.gp, aes(x = EEZ, y = Pwgt, fill = factor(Bin))) + geom_bar(stat = "identity", position = "stack") +
facet_wrap(~ Species, ncol = 1) + labs(fill = "Size bin")
print(pl)
dev.off()
calc_tonne_value <- function(lendat = cl.len, catdat = agdat, type = "foreign-eez", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
EZplot = "FM", useCap = NULL){
if(type == "foreign-eez") catdat %<>% filter(fleet == "Foreign", EEZ %in% keep.ez) %>% mutate(SelCol = EEZ)
if(type == "domestic-eez") catdat %<>% filter(fleet == "Domestic", EEZ %in% keep.ez) %>% mutate(SelCol = EEZ)
if(type == "domestic-all") catdat %<>% mutate(SelCol = flag)
if(nrow(catdat) == 0) return()
cat.dat <- catdat %>% filter(between(yy, fst.yr, last.yr), SelCol == EZplot, school != "OTH") %>%
mutate(NewStat = ifelse(Status == "Open" & school == "UNA", "UNA No closure", "UNA Closure"),
NewStat = ifelse(school == "ASS", "ASS", NewStat)) %>%
rename(Bigeye = bet_mt, Skipjack = skj_mt, Yellowfin = yft_mt)
cat.lng <- cat.dat %>% pivot_longer(cols = c(Bigeye,Skipjack,Yellowfin), names_to = "Species", values_to = "Catch")
len.dat <- lendat %>% filter(between(yy, fst.yr, last.yr), EEZ == EZplot, SchID != "OTH") %>%
mutate(TwgtMT = Twgt / 1000, TwgtPc = TwgtMT * Price,
NewStat = ifelse(Status == "Open" & SchID == "UNA", "UNA No closure", "UNA Closure"),
NewStat = ifelse(SchID == "ASS", "ASS", NewStat))
# Detailed summaries
cat.sum <- cat.lng %>% filter(SelCol == EZplot) %>% group_by(NewStat, Species) %>% summarise(Catch = sum(Catch), Effort = sum(stdeff)/3) %>%
mutate(Pcatch = Catch/sum(Catch))
len.sum <- len.dat %>% group_by(NewStat, Species) %>% summarise(TotWgt = sum(TwgtMT), TotPc = sum(TwgtPc)) %>% mutate(VpT = TotPc / TotWgt)
agg.sum <- left_join(cat.sum, len.sum, by = c("Species","NewStat")) %>% mutate(tmpV = VpT * Pcatch)
val.tab1 <- agg.sum %>% group_by(Status = NewStat) %>% summarise(VpT = sum(tmpV), Catch = sum(Catch), Effort = sum(Effort)) %>%
mutate(CpD = Catch / Effort, VpD = VpT * CpD) # Note that this is the CPUE of the sums not the mean of the annual CPUE's
# Overall summaries
cat.sum <- cat.lng %>% filter(SelCol == EZplot) %>% group_by(Status, Species) %>% summarise(Catch = sum(Catch), Effort = sum(stdeff)/3) %>%
mutate(Pcatch = Catch/sum(Catch))
len.sum <- len.dat %>% group_by(Status, Species) %>% summarise(TotWgt = sum(TwgtMT), TotPc = sum(TwgtPc)) %>% mutate(VpT = TotPc / TotWgt)
agg.sum <- left_join(cat.sum, len.sum, by = c("Species","Status")) %>% mutate(tmpV = VpT * Pcatch)
val.tab2 <- agg.sum %>% group_by(Status) %>% summarise(VpT = sum(tmpV), Catch = sum(Catch), Effort = sum(Effort)) %>%
mutate(CpD = Catch / Effort, VpD = VpT * CpD)
tmp.stat <- data.frame(Status = c("Open","Closure"))      # For occasions when there are missing values for certain fleets
val.tab2 <- left_join(tmp.stat, val.tab2, by = "Status")
if(type == "foreign-eez") plot.tit <- paste0("Foreign (", EZplot," EEZ)")
if(type == "domestic-eez") plot.tit <- paste0(EZplot, " fleet (", EZplot," EEZ)")
if(type == "domestic-all") plot.tit <- paste0(EZplot, " fleet (all areas)")
pl1 <- ggplot(val.tab2, aes(x = reorder(Status, desc(Status)), y = VpD, fill = Status)) + geom_bar(stat = "identity") +
geom_text(aes(label = comma(round(VpD))), vjust = -0.5, size = 7) +
xlab("") + ylab("Value per day ($US)") + theme_classic() +
scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE), expand = expansion(mult = c(0.03, 0.15))) +
ggtitle(plot.tit) +
scale_fill_manual(values = c("steelblue2","lightsteelblue2")) +
theme(legend.position = "none", axis.text = element_text(size = 18),
axis.title = element_text(size = 20), plot.title = element_text(size = 18, hjust = 1))
pl2 <- ggplot(val.tab2, aes(x = reorder(Status, desc(Status)), y = CpD, fill = Status)) + geom_bar(stat = "identity") +
geom_text(aes(label = round(CpD, 1)), vjust = -0.5, size = 7) +
xlab("") + ylab("Catch per day (mt)") + theme_classic() + scale_y_continuous(position = "right", expand = expansion(mult = c(0.03, 0.15))) +
scale_fill_manual(values = c("steelblue2","lightsteelblue2")) +
ggtitle("") +
theme(legend.position = "none", axis.text = element_text(size = 18),
axis.title = element_text(size = 20), plot.title = element_text(size = 18, hjust = 1))
windows(4500,5000)
grid.arrange(pl1, pl2, ncol=2)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, "_Value_Table_", type, ".png"), type = "png")
dev.off()
val.tab2 %<>% mutate(Status = ifelse(Status == "Open", "No closure all sets", "Closure all sets")) %>% arrange(desc(Status))
val.tabs <- rbind(val.tab1, val.tab2)
# Combined
comb.tab <- val.tabs %>% select(Status, "Value per tonne (\\$US)" = VpT, "Catch per day (mt)" = CpD, "Value per day (\\$US)" = VpD)
pr.xtab <- xtable(comb.tab, align = c("l","l","c","c","c"), label = paste0("tab:", type), digits = c(0,0,0,1,0),
caption = useCap)
print.xtable(pr.xtab, file = paste0(base.dir, "Tables/", EZplot, "/", EZplot, "_Value_Table_", type, ".tex"), include.rownames = FALSE,
sanitize.text.function = function(x) x, size = "normalsize", format.args = list(big.mark = ","), table.placement="H")
return(val.tabs)
}
for.eez.val <- lapply(keep.ez, function(x) calc_tonne_value(lendat = cl.len, catdat = agdat, type = "foreign-eez",
fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez, EZplot = x, useCap = paste0("Fleet-specific
estimates of average landed value per metric tonne (left), catch in weight {\\bf per day} (centre), and the resulting landed value per day
(right) for all fish caught on FADs, caught on free schools during non-closure months, and caught on free schools during closure
months from 2009-", last.yr, ". Values are based on recent catch prices (Table \\ref{tab1}). The values in the lower two rows of each table (`No closure all sets', `Closure all sets')
correspond to those in Figure \\ref{fig:values}."))); names(for.eez.val) <- keep.ez
dom.eez.val <- lapply(keep.ez[!(keep.ez == "TK")], function(x) calc_tonne_value(lendat = cl.len, catdat = agdat, type = "domestic-eez",
fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez, EZplot = x,
useCap = NULL)); names(dom.eez.val) <- keep.ez[!(keep.ez == "TK")]
dom.all.val <- lapply(keep.ez[!(keep.ez == "TK")], function(x) calc_tonne_value(lendat = cl.len, catdat = agdat, type = "domestic-all",
fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez, EZplot = x,
useCap = NULL)); names(dom.all.val) <- keep.ez[!(keep.ez == "TK")]
plot_sml_proportions <- function(dat = agdat, sml.bin = sml.bin, type = "foreign-eez", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
EZplot = "FM", sv.name = "_SmlFishProp_Agdat_for-eez", Set.lim = 20){
if(type == "foreign-eez") dat %<>% filter(fleet == "Foreign", EEZ %in% keep.ez) %>% mutate(SelCol = EEZ)
if(type == "domestic-eez") dat %<>% filter(fleet == "Domestic", EEZ %in% keep.ez) %>% mutate(SelCol = EEZ)
if(type == "domestic-all") dat %<>% mutate(SelCol = flag)
cat.dat <- dat %>% filter(between(yy, fst.yr, last.yr), SelCol %in% keep.ez, school != "OTH", Status == "Open")
cat.gp <- cat.dat %>% group_by(EEZ = SelCol, school) %>%
summarise(Sets = sum(sets), BET = sum(bet_mt), SKJ = sum(skj_mt), YFT = sum(yft_mt)) %>%
mutate(TOT = BET + SKJ + YFT, Bigeye = BET / TOT, Skipjack = SKJ / TOT, Yellowfin = YFT / TOT)
cat.gp.pl <- cat.gp %>% filter(school == "ASS", Sets > Set.lim) %>%
pivot_longer(cols = c("Bigeye","Skipjack","Yellowfin"), names_to = "Species", values_to = "Pcaught")
cat.gp.pl <- left_join(sml.bin, cat.gp.pl, by = c("EEZ","Species")) %>% mutate(Psml = Pfish * Pcaught, Psmlw = Pwgt * Pcaught) %>%
filter(Species != "Skipjack")
cat.gp.pl$Species <- factor(cat.gp.pl$Species, levels = c("Yellowfin","Bigeye"))
cat.gp.pl$Xlbl <- ifelse(cat.gp.pl$EEZ == EZplot, EZplot, " ")
windows(3000,3000)
pl <- ggplot(cat.gp.pl, aes(x = reorder(EEZ, -Psml), y = Psml*100, fill = Species)) + geom_bar(stat = "identity", position = "stack", colour = "black") +
xlab("") + ylab("%") +
coord_flip() +
scale_fill_manual(values = c("gold1","firebrick2")) +
scale_x_discrete(expand = expansion(mult = c(0.1, 0.15))) +
scale_y_continuous(expand = expansion(mult = c(0.03, 0.3))) +
theme(legend.position = c(0.8,0.88), legend.title = element_blank(), legend.key.size = unit(1.3, "cm"),
legend.text = element_text(size = 20), panel.border = element_blank(),
axis.line = element_line(color = 'black'), panel.grid.major.y = NULL,
axis.title = element_text(size = 20), axis.text = element_text(size = 20))
print(pl)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, "_ByNumbers", ".png"), type = "png")
cat.gp.sum <- cat.gp.pl %>% group_by(EEZ) %>% summarise(Ptot = sum(Psml)) %>% mutate(Ptot = ifelse(is.na(Ptot), 0, Ptot), EEZ = ifelse(EEZ == EZplot, EZplot, " ")) %>% arrange(Ptot)
pl <- pl + scale_x_discrete(label = rev(cat.gp.sum$EEZ), expand = expansion(mult = c(0.1, 0.15)))
print(pl)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, "_ByNumbers_HiddenLbl.png"), type = "png")
dev.off()
windows(3000,3000)
pl <- ggplot(cat.gp.pl, aes(x = reorder(EEZ, -Psmlw), y = Psmlw*100, fill = Species)) + geom_bar(stat = "identity", position = "stack", colour = "black") +
xlab("") + ylab("%") +
coord_flip() +
scale_fill_manual(values = c("gold1","firebrick2")) +
scale_x_discrete(expand = expansion(mult = c(0.1, 0.15))) +
scale_y_continuous(expand = expansion(mult = c(0.03, 0.3))) +
theme(legend.position = c(0.8,0.88), legend.title = element_blank(), legend.key.size = unit(1.3, "cm"),
legend.text = element_text(size = 20), panel.border = element_blank(),
axis.line = element_line(color = 'black'), panel.grid.major.y = NULL,
axis.title = element_text(size = 20), axis.text = element_text(size = 20))
print(pl)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, "_ByWeight", ".png"), type = "png")
cat.gp.sum <- cat.gp.pl %>% group_by(EEZ) %>% summarise(Ptot = sum(Psmlw)) %>% mutate(Ptot = ifelse(is.na(Ptot), 0, Ptot), EEZ = ifelse(EEZ == EZplot, EZplot, " ")) %>% arrange(Ptot)
pl <- pl + scale_x_discrete(label = rev(cat.gp.sum$EEZ), expand = expansion(mult = c(0.1, 0.15)))
print(pl)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, "_ByWeight_HiddenLbl.png"), type = "png")
dev.off()
return(cat.gp.pl)
}
# Aggregate data - late period after FAD closure establishment
for.eez.sml <- lapply(keep.ez, function(x) plot_sml_proportions(dat = agdat, sml.bin = sml.bin, type = "foreign-eez", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
EZplot = x, sv.name = "_Psml_Agdat_for-eez", Set.lim = 20))
dom.eez.sml <- lapply(keep.ez, function(x) plot_sml_proportions(dat = agdat, sml.bin = sml.bin, type = "domestic-eez", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
EZplot = x, sv.name = "_Psml_Agdat_dom-eez", Set.lim = 20))
dom.all.sml <- lapply(keep.ez, function(x) plot_sml_proportions(dat = agdat, sml.bin = sml.bin, type = "domestic-all", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
EZplot = x, sv.name = "_Psml_Agdat_dom-all", Set.lim = 20))
# Each element of the list is the same so just need to keep the 1st one for each list
for.eez.sml <- for.eez.sml[[1]]
dom.eez.sml <- dom.eez.sml[[1]]
dom.all.sml <- dom.all.sml[[1]]
# Aggregate data - early period prior to FAD closure establishment
for.eez.sml.early <- lapply(keep.ez, function(x) plot_sml_proportions(dat = agdat, sml.bin = sml.bin, type = "foreign-eez", fst.yr = 2000, last.yr = 2008, keep.ez = keep.ez,
EZplot = x, sv.name = "_Psml_Agdat_for-eez_Early", Set.lim = 20))
dom.eez.sml.early <- lapply(keep.ez, function(x) plot_sml_proportions(dat = agdat, sml.bin = sml.bin, type = "domestic-eez", fst.yr = 2000, last.yr = 2008, keep.ez = keep.ez,
EZplot = x, sv.name = "_Psml_Agdat_dom-eez_Early", Set.lim = 20))
dom.all.sml.early <- lapply(keep.ez, function(x) plot_sml_proportions(dat = agdat, sml.bin = sml.bin, type = "domestic-all", fst.yr = 2000, last.yr = 2008, keep.ez = keep.ez,
EZplot = x, sv.name = "_Psml_Agdat_dom-all_Early", Set.lim = 20))
# Each element of the list is the same so just need to keep the 1st one for each list
for.eez.sml.early <- for.eez.sml.early[[1]]
dom.eez.sml.early <- dom.eez.sml.early[[1]]
dom.all.sml.early <- dom.all.sml.early[[1]]
plot_FAD_reliance <- function(dat = agdat, type = "foreign-eez", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
EZplot = "FM", sv.name = "_FAD_Reliance_Agdat_for-eez", Set.lim = 20){
if(type == "foreign-eez") dat %<>% filter(fleet == "Foreign", EEZ %in% keep.ez) %>% mutate(SelCol = EEZ)
if(type == "domestic-eez") dat %<>% filter(fleet == "Domestic", EEZ %in% keep.ez) %>% mutate(SelCol = EEZ)
if(type == "domestic-all") dat %<>% mutate(SelCol = flag)
rel.dat <- dat %>% filter(between(yy, fst.yr, last.yr), SelCol %in% keep.ez, school != "OTH", Status == "Open")
rel.gp <- rel.dat %>% group_by(EEZ = SelCol, school) %>% summarise(Sets = sum(sets)) %>%
mutate(Pfads = Sets / sum(Sets))
rel.gp.pl <- filter(rel.gp, school == "ASS", Sets > Set.lim)
all.eez <- data.frame(EEZ = keep.ez)
rel.gp.pl <- left_join(all.eez, rel.gp.pl, by = "EEZ")
rel.gp.pl[is.na(rel.gp.pl)] <- 0
rel.gp.pl$Xlbl <- ifelse(rel.gp.pl$EEZ == EZplot, EZplot, " ")
rel.gp.pl %<>% arrange(Pfads)
if(type == "foreign-eez") plot.tit <- "Foreign fleet in PICT EEZ's"
if(type == "domestic-eez") plot.tit <- "Domestic fleets within their EEZ's"
if(type == "domestic-all") plot.tit <- "Domestic fleets over all areas"
windows(3000,3000)
pl <- ggplot(rel.gp.pl, aes(x = reorder(EEZ, -Pfads), y = Pfads*100)) + geom_bar(stat = "identity", fill = "wheat", colour = "black") +
xlab("") + ylab("%") +
coord_flip() +
annotate("text", x = Inf, y = Inf, label = plot.tit, hjust = 1, vjust = 1, size = 7) +
scale_x_discrete(expand = expansion(mult = c(0.1, 0.15))) +
scale_y_continuous(limits = c(0, NA), expand = expansion(mult = c(0.03, 0.25))) +
theme(panel.border = element_blank(), plot.margin = margin(.2, 1.2, .2, .2, "cm"),
axis.line = element_line(color = 'black'), panel.grid.major.y = NULL,
axis.title = element_text(size = 20), axis.text = element_text(size = 20))
print(pl)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, ".png"), type = "png")
pl <- pl + scale_x_discrete(label = rev(rel.gp.pl$Xlbl), expand = expansion(mult = c(0.1, 0.15)))
print(pl)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, "_hiddenLbl.png"), type = "png")
dev.off()
return(rel.gp.pl)
}
# Agregate data late period
for.eez.rel <- lapply(keep.ez, function(x) plot_FAD_reliance(dat = agdat, type = "foreign-eez", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
EZplot = x, sv.name = "_FAD_Reliance_Agdat_for-eez_late", Set.lim = 20))
dom.eez.rel <- lapply(keep.ez, function(x) plot_FAD_reliance(dat = agdat, type = "domestic-eez", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
EZplot = x, sv.name = "_FAD_Reliance_Agdat_dom-eez_late", Set.lim = 20))
dom.all.rel <- lapply(keep.ez, function(x) plot_FAD_reliance(dat = agdat, type = "domestic-all", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
EZplot = x, sv.name = "_FAD_Reliance_Agdat_dom-all_late", Set.lim = 20))
# Each element of the list is the same so just need to keep the 1st one for each list
for.eez.rel <- for.eez.rel[[1]]
dom.eez.rel <- dom.eez.rel[[1]]
dom.all.rel <- dom.all.rel[[1]]
# Agregate data early period
for.eez.rel.early <- lapply(keep.ez, function(x) plot_FAD_reliance(dat = agdat, type = "foreign-eez", fst.yr = 2000, last.yr = 2008, keep.ez = keep.ez,
EZplot = x, sv.name = "_FAD_Reliance_Agdat_for-eez_early", Set.lim = 20))
dom.eez.rel.early <- lapply(keep.ez, function(x) plot_FAD_reliance(dat = agdat, type = "domestic-eez", fst.yr = 2000, last.yr = 2008, keep.ez = keep.ez,
EZplot = x, sv.name = "_FAD_Reliance_Agdat_dom-eez_early", Set.lim = 20))
dom.all.rel.early <- lapply(keep.ez, function(x) plot_FAD_reliance(dat = agdat, type = "domestic-all", fst.yr = 2000, last.yr = 2008, keep.ez = keep.ez,
EZplot = x, sv.name = "_FAD_Reliance_Agdat_dom-all_early", Set.lim = 20))
# Each element of the list is the same so just need to keep the 1st one for each list
for.eez.rel.early <- for.eez.rel.early[[1]]
dom.eez.rel.early <- dom.eez.rel.early[[1]]
dom.all.rel.early <- dom.all.rel.early[[1]]
# Operational data
# for.eez.rel.op <- lapply(keep.ez, function(x) plot_FAD_reliance(dat = opdat, type = "foreign-eez", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
#                                                                 EZplot = x, sv.name = "_FAD_Reliance_Opdat_for-eez_late", Set.lim = 20))
#
# dom.eez.rel.op <- lapply(keep.ez, function(x) plot_FAD_reliance(dat = opdat, type = "domestic-eez", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
#                                                                 EZplot = x, sv.name = "_FAD_Reliance_Opdat_dom-eez_late", Set.lim = 20))
#
# dom.all.rel.op <- lapply(keep.ez, function(x) plot_FAD_reliance(dat = opdat, type = "domestic-all", fst.yr = fst.yr, last.yr = last.yr, keep.ez = keep.ez,
#                                                                 EZplot = x, sv.name = "_FAD_Reliance_Opdat_dom-all_late", Set.lim = 20))
plot_effort_series <- function(dat = agdat, type = "foreign-eez", yr.range = c(2000,fst.yr,last.yr), keep.ez = keep.ez,
FADcls = FADcls, EZplot = "FM", sv.name = "_Agdat_2000-19"){
col.match <- data.frame(grp = c("UNA Closure","UNA Open","ASS Closure","ASS Open"),
grpcol = c("royalblue4","steelblue1","darkred","firebrick2"))
if(type == "foreign-eez") dat %<>% filter(fleet == "Foreign", EEZ %in% keep.ez) %>% mutate(SelCol = EEZ)
if(type == "domestic-eez") dat %<>% filter(fleet == "Domestic", EEZ %in% keep.ez) %>% mutate(SelCol = EEZ)
if(type == "domestic-all") dat %<>% mutate(SelCol = flag)
if(type == "domestic-hseas") dat %<>% filter(EEZ %in% hs.ez) %>% mutate(SelCol = flag)
all.yrmth <- expand.grid(yy = yr.range[1]:yr.range[3], mm = 1:12, school = c("ASS","UNA"))
eff.yrmth <- dat %>% filter(school %in% c("ASS","UNA")) %>% group_by(yy, mm, SelCol, school) %>%
summarise(Sets = sum(sets, na.rm = T), Catch = sum(sel_mt, na.rm = T)) %>% filter(SelCol == EZplot)
eff.yrmth <- left_join(all.yrmth, eff.yrmth, by = c("yy","mm","school")) %>% mutate(Yrmth = yy + (mm - 0.5)/12)
eff.yrmth <- left_join(eff.yrmth, FADcls, by = c("yy","mm")) %>%
mutate(Grp = factor(paste(school, Status), levels = c("UNA Open","ASS Open","UNA Closure","ASS Closure")))
cpue.yr <- eff.yrmth %>% mutate(Grp = as.character(Grp), Grp = ifelse(Grp %in% c("ASS Open", "ASS Closure"), "ASS", Grp)) %>%
group_by(yy, Grp) %>% summarise(Sets = sum(Sets, na.rm = T), Catch = sum(Catch, na.rm = T)) %>%
mutate(CPUE = Catch / Sets) %>% as.data.frame
eff.pl <- eff.yrmth %>% filter(between(yy, yr.range[2], yr.range[3]))
if(type == "foreign-eez") plot.tit <- paste0("Foreign fleet (", EZplot," EEZ)")
if(type == "domestic-eez") plot.tit <- paste0(EZplot, " fleet (", EZplot," EEZ)")
if(type == "domestic-all") plot.tit <- paste0(EZplot, " fleet (all areas)")
if(type == "domestic-hseas") plot.tit <- paste0(EZplot, " fleet (high seas)")
windows(11000,3000)
pl1 <- ggplot(eff.pl, aes(x = Yrmth, y = Sets, fill = Grp)) + geom_bar(stat = "identity", position = "stack", colour = "black", width = 1/12) +
scale_fill_manual(values = c("steelblue1","firebrick2","royalblue4","darkred"), drop = FALSE) + xlab("") +
scale_x_continuous(limits = c(yr.range[2], yr.range[3] + 1), breaks = seq(yr.range[2], yr.range[3], 1), minor_breaks = NULL, expand = c(0.01,0.01)) +
scale_y_continuous(limits = c(0,NA), labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
annotate("text", x = -Inf, y = Inf, label = plot.tit, hjust = -0.1, vjust = 1, size = 7) +
theme(legend.title = element_blank(), legend.key.size = unit(0.7, "cm"),
legend.text = element_text(size = 14), panel.border = element_blank(),
axis.line = element_line(color = 'black'), panel.grid.major.y = NULL,
panel.grid.major.x = element_line(size=.5, color="black", linetype = 2),
axis.title = element_text(size = 15), axis.text.y = element_text(size = 15), axis.text.x = element_text(size = 15, hjust = 0))
print(pl1)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, "_mth_Late", ".png"), type = "png")
dev.off()
windows(11000,3000)
pl2 <- ggplot(cpue.yr, aes(x = yy, y = CPUE, colour = Grp)) +
geom_rect(aes(xmin=2008.5, xmax=Inf, ymin=0, ymax=Inf), colour=alpha("wheat1", 0.01), fill=alpha("wheat1", 0.01)) +
geom_vline(xintercept = 2008.5, linetype = 2) +
geom_line(size = 1.8) + geom_point(size = 4) +
scale_colour_manual(values = c("firebrick2","royalblue4","steelblue1"), drop = FALSE) + xlab("") +
scale_x_continuous(limits = c(yr.range[1], yr.range[3]), breaks = seq(yr.range[1], yr.range[3], 2),
minor_breaks = seq(yr.range[1], yr.range[3], 1), expand = c(0.03,0.03)) +
scale_y_continuous(limits = c(0,NA)) +
annotate("text", x = -Inf, y = -Inf, label = plot.tit, hjust = -0.1, vjust = -1, size = 7) +
theme(legend.title = element_blank(), legend.key.size = unit(0.7, "cm"),
legend.text = element_text(size = 14), panel.border = element_blank(), axis.line = element_line(color = 'black'),
axis.title = element_text(size = 15), axis.text = element_text(size = 15))
print(pl2)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, "_CPUE_Year", ".png"), type = "png")
dev.off()
eff.pl <- eff.yrmth %>% filter(between(yy, yr.range[1], yr.range[2] - 1), SelCol == EZplot)
windows(11000,3000)
pl3 <- ggplot(eff.pl, aes(x = Yrmth, y = Sets, fill = Grp)) + geom_bar(stat = "identity", position = "stack", colour = "black", width = 1/12) +
scale_fill_manual(values = c("steelblue1","firebrick2","royalblue4","darkred"), drop = FALSE) + xlab("") +
scale_x_continuous(limits = c(yr.range[1], yr.range[2] + 1), breaks = seq(yr.range[1], yr.range[2], 1), minor_breaks = NULL, expand = c(0.01,0.01)) +
scale_y_continuous(limits = c(0,NA), labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
annotate("text", x = -Inf, y = Inf, label = plot.tit, hjust = -0.1, vjust = 1, size = 7) +
theme(legend.title = element_blank(), legend.key.size = unit(0.7, "cm"),
legend.text = element_text(size = 14), panel.border = element_blank(),
axis.line = element_line(color = 'black'), panel.grid.major.y = NULL,
panel.grid.major.x = element_line(size=.5, color="black", linetype = 2),
axis.title = element_text(size = 15), axis.text.y = element_text(size = 15), axis.text.x = element_text(size = 15, hjust = 0))
print(pl3)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, "_mth_Early", ".png"), type = "png")
dev.off()
eff.yr <- eff.yrmth %>% filter(between(yy, yr.range[1], yr.range[3]), SelCol == EZplot) %>% group_by(yy, Grp) %>%
summarise(Sets = sum(Sets, na.rm = T)) %>% mutate(Grp = factor(Grp, levels = c("UNA Closure","UNA Open","ASS Closure","ASS Open")))
if(nrow(eff.yr) == 0) eff.yr <- data.frame(yy = 2010, Grp = c("UNA Closure","UNA Open","ASS Closure","ASS Open"), Sets = 0)
#tmpcols <- col.match$grpcol[match(sort(unique(eff.yr$Grp)), col.match$grp)]
windows(11000,4500)
pl4 <- ggplot(eff.yr, aes(x = yy, y = Sets, fill = Grp)) +
geom_rect(aes(xmin=2008.5, xmax=Inf, ymin=0, ymax=Inf), colour=alpha("wheat1", 0.01), fill=alpha("wheat1", 0.01)) +
geom_vline(xintercept = 2008.5, linetype = 2) +
geom_bar(stat = "identity", position = "stack", colour = "black", width = 0.85) + xlab("") +
scale_fill_manual(name = paste(plot.tit, "               "), values = c("royalblue4","steelblue1","darkred","firebrick2"), drop = FALSE) +
scale_x_continuous(limits = c(yr.range[1] - .5, yr.range[3] + .5), breaks = seq(yr.range[1], yr.range[3], 2),
minor_breaks = seq(yr.range[1], yr.range[3], 1), expand = c(0.01,0.01)) +
scale_y_continuous(limits = c(0,NA), labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
theme(legend.title = element_text(size = 22), legend.key.size = unit(0.7, "cm"),
legend.text = element_text(size = 14), panel.border = element_blank(),
axis.line = element_line(size=.5, color="black"),
axis.title = element_text(size = 15), axis.text = element_text(size = 15),
legend.position = "top")
print(pl4)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, "_yr_All", ".png"), type = "png")
dev.off()
eff.yr <- eff.yrmth %>% filter(between(yy, yr.range[1], yr.range[3]), SelCol == EZplot) %>% group_by(yy, school) %>%
summarise(Sets = sum(Sets, na.rm = T)) %>% mutate(school = factor(school, levels = c("UNA","ASS")))
if(nrow(eff.yr) == 0) eff.yr <- data.frame(yy = 2010, school = c("UNA","ASS"), Sets = 0)
windows(11000,4500)
pl5 <- ggplot(eff.yr, aes(x = yy, y = Sets, fill = school)) +
geom_vline(xintercept = 2008.5, linetype = 2) +
geom_bar(stat = "identity", position = "fill", colour = "black", width = 0.85) +
scale_fill_manual(values = c("royalblue4","firebrick2")) + xlab("") + ylab("Percentage of sets") +
scale_x_continuous(limits = c(yr.range[1] - .5, yr.range[3] + .5), breaks = seq(yr.range[1], yr.range[3], 2),
minor_breaks = seq(yr.range[1], yr.range[3], 1), expand = c(0.01,0.01)) +
scale_y_continuous(limits = c(0,NA), breaks = seq(0, 1, 0.25), labels = c("0","25","50","75","100")) +
theme(legend.title = element_blank(), legend.key.size = unit(0.7, "cm"),
legend.text = element_text(size = 14), panel.border = element_blank(),
axis.line = element_line(size=.5, color="black"),
axis.title = element_text(size = 15), axis.text = element_text(size = 15),
legend.position = "top")
print(pl5)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, sv.name, "_yr_All_Prop", ".png"), type = "png")
dev.off()
ann.eff <- eff.yr %>% filter(yy >= fst.yr) %>% group_by(yy) %>% summarise(Sets = sum(Sets))
return(list(pl1, pl2, pl3, pl4, pl5, ann.eff = ann.eff))
}
# Aggregate data
for.eez.eff <- lapply(keep.ez, function(x) plot_effort_series(dat = agdat, type = "foreign-eez", yr.range = c(start.yr,fst.yr,last.yr), keep.ez = keep.ez,
FADcls = FADcls, EZplot = x, sv.name = "_Agdat_for-eez_2000-Current")); names(for.eez.eff) <- keep.ez
dom.eez.eff <- lapply(keep.ez, function(x) plot_effort_series(dat = agdat, type = "domestic-eez", yr.range = c(start.yr,fst.yr,last.yr), keep.ez = keep.ez,
FADcls = FADcls, EZplot = x, sv.name = "_Agdat_dom-eez_2000-Current")); names(dom.eez.eff) <- keep.ez
dom.all.eff <- lapply(keep.ez, function(x) plot_effort_series(dat = agdat, type = "domestic-all", yr.range = c(start.yr,fst.yr,last.yr), keep.ez = keep.ez,
FADcls = FADcls, EZplot = x, sv.name = "_Agdat_dom-all_2000-Current")); names(dom.all.eff) <- keep.ez
dom.hs.eff <- lapply(keep.ez, function(x) plot_effort_series(dat = agdat, type = "domestic-hseas", yr.range = c(start.yr,fst.yr,last.yr), keep.ez = keep.ez,
FADcls = FADcls, EZplot = x, sv.name = "_Agdat_dom-highseas_2000-Current")); names(dom.hs.eff) <- keep.ez
# Operational data
# for.eez.eff.op <- lapply(keep.ez, function(x) plot_effort_series(dat = opdat, type = "foreign-eez", yr.range = c(start.yr,fst.yr,last.yr), keep.ez = keep.ez,
#                                                           FADcls = FADcls, EZplot = x, sv.name = "_Opdat_for-eez_2000-Current"))
#
# dom.eez.eff.op <- lapply(keep.ez, function(x) plot_effort_series(dat = opdat, type = "domestic-eez", yr.range = c(start.yr,fst.yr,last.yr), keep.ez = keep.ez,
#                                                           FADcls = FADcls, EZplot = x, sv.name = "_Opdat_dom-eez_2000-Current"))
#
# dom.all.eff.op <- lapply(keep.ez, function(x) plot_effort_series(dat = opdat, type = "domestic-all", yr.range = c(start.yr,fst.yr,last.yr), keep.ez = keep.ez,
#                                                           FADcls = FADcls, EZplot = x, sv.name = "_Opdat_dom-all_2000-Current"))
plot_effort_boxplots <- function(dat = agdat, yr.range = c(2000,fst.yr,last.yr), keep.ez = keep.ez,
FADcls = FADcls, EZplot = "FM"){
datfil <- filter(dat, EEZ == EZplot, between(yy, yr.range[1], yr.range[3])) %>%
mutate(Period = ifelse(yy <= yr.range[2], "Before closure", "After closure"))
for.tab <- datfil %>% filter(fleet == "Foreign") %>% group_by(yy, Period) %>% summarise(Days = sum(stdeff)) %>%
mutate(Fleet = "(Foreign)", Fac = paste(Period, Fleet))
tot.tab <- datfil %>% group_by(yy, Period) %>% summarise(Days = sum(stdeff)) %>%
mutate(Fleet = "(Foreign+domestic)", Fac = paste(Period, Fleet))
all.tab <- rbind(for.tab, tot.tab) %>% as.data.frame
all.tab$ref.fac <- factor(all.tab$Fac, levels = c("Before closure (Foreign)","After closure (Foreign)",
"Before closure (Foreign+domestic)","After closure (Foreign+domestic)"))
datfil.tot <- filter(dat, EEZ %in% keep.ez, between(yy, yr.range[1], yr.range[3])) %>%
mutate(Period = ifelse(yy <= yr.range[2], "Before closure", "After closure"))
for.tab.tot <- datfil.tot %>% filter(fleet == "Foreign") %>% group_by(yy, Period) %>% summarise(TDays = sum(stdeff)) %>%
mutate(Fleet = "(Foreign)", Fac = paste(Period, Fleet))
tot.tab.tot <- datfil.tot %>% group_by(yy, Period) %>% summarise(TDays = sum(stdeff)) %>%
mutate(Fleet = "(Foreign+domestic)", Fac = paste(Period, Fleet))
all.tab.tot <- tot.tab.tot#rbind(for.tab.tot, tot.tab.tot)
all.tab.tot$ref.fac <- factor(all.tab.tot$Fac, levels = c("Before closure (Foreign)","After closure (Foreign)",
"Before closure (Foreign+domestic)","After closure (Foreign+domestic)"))
pl1 <- ggplot(all.tab, aes(x = ref.fac, y = Days, fill = Period)) + stat_boxplot(geom = "errorbar", width = 0.2, size = 0.8) +
geom_boxplot(size = 0.8) +
geom_vline(xintercept = 2.5, size = 1, linetype = "longdash") +
xlab("") +
scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
scale_fill_manual(values = c("lightsalmon2","powderblue")) +
theme(legend.title = element_blank(), legend.key.size = unit(1, "cm"),
legend.text = element_text(size = 16), legend.position = "top",
axis.title = element_text(size = 16), axis.text = element_text(size = 13))
comb.tab <- left_join(all.tab.tot, all.tab, by = c("yy","Period")) %>% mutate(Pdays = Days/TDays) %>% filter(!is.na(Pdays))
pl2 <- ggplot(comb.tab, aes(x = ref.fac.y, y = Pdays*100, fill = Period)) + stat_boxplot(geom = "errorbar", width = 0.2, size = 0.8) +
geom_boxplot(size = 0.8) +
geom_vline(xintercept = 2.5, size = 1, linetype = "longdash") +
xlab("") + ylab(paste0("Percentage days fished in ", EZplot, " EEZ")) +
scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
scale_fill_manual(values = c("lightsalmon2","powderblue")) +
theme(legend.title = element_blank(), legend.key.size = unit(1, "cm"),
legend.text = element_text(size = 16), legend.position = "top",
axis.title = element_text(size = 16), axis.text = element_text(size = 13))
windows(8000,5000)
grid.arrange(pl1, pl2)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, "_Prop_Days_Fished.png"), type = "png")
dev.off()
return(comb.tab)
}
# Produce and save the boxplots of days and proportion of total PNA effort fished before and after 2009
all.box.plots <- lapply(keep.ez, function(x) plot_effort_boxplots(dat = agdat, yr.range = c(2000,fst.yr,last.yr), keep.ez = keep.ez,
FADcls = FADcls, EZplot = x)); names(all.box.plots) <- keep.ez
full.dat <- list(for.eez.val = for.eez.val, dom.eez.val = dom.eez.val, dom.all.val = dom.all.val,
for.eez.sml = for.eez.sml, dom.eez.sml = dom.eez.sml, dom.all.sml = dom.all.sml,
for.eez.sml.early = for.eez.sml.early, dom.eez.sml.early = dom.eez.sml.early, dom.all.sml.early = dom.all.sml.early,
for.eez.rel = for.eez.rel, dom.eez.rel = dom.eez.rel, dom.all.rel = dom.all.rel,
for.eez.rel.early = for.eez.rel.early, dom.eez.rel.early = dom.eez.rel.early, dom.all.rel.early = dom.all.rel.early,
for.eez.eff = for.eez.eff, dom.eez.eff = dom.eez.eff, dom.all.eff = dom.all.eff,
all.box.plots = all.box.plots)
predict_lost_value <- function(dat = agdat, yr.range = c(2000,fst.yr,last.yr), EZplot = "FM"){
dat %<>% filter(fleet == "Foreign", EEZ == EZplot)
dat.ea <- filter(dat, between(yy, yr.range[1], yr.range[2] - 1))
dat.lt <- filter(dat, between(yy, yr.range[2], yr.range[3]))
sum.ea <- dat.ea %>% group_by(mm) %>% summarise(Days.ea = sum(stdeff), Catch.ea = sum(sel_mt))
dat.lt.mth <- dat.lt %>% group_by(yy, mm, Mon, Status) %>% summarise(Days.lt = sum(stdeff), Catch.lt = sum(sel_mt))
dat.lt.comb <- left_join(dat.lt.mth, sum.ea, by = "mm") %>% group_by(yy, Status) %>%
summarise(Days.lt = sum(Days.lt), Catch.lt = sum(Catch.lt), Days.ea = sum(Days.ea), Catch.ea = sum(Catch.ea)) %>%
mutate(P.Days.lt = Days.lt/sum(Days.lt), P.Catch.lt = Catch.lt/sum(Catch.lt),
P.Days.ea = Days.ea/sum(Days.ea), P.Catch.ea = Catch.ea/sum(Catch.ea),
CpD.lt = Catch.lt/Days.lt, CpD.ea = Catch.ea/Days.ea)
calc.stats <- function(t = fst.yr){
tmp <- filter(dat.lt.comb, yy == t)
tmp.val <- rev(full.dat$for.eez.val[[EZplot]]$VpT[4:5])
pre.CpD <- tmp$CpD.ea[1] / tmp$CpD.ea[2] * tmp$CpD.lt[2]
pre.Days <- sum(tmp$Days.lt) * tmp$P.Days.ea
pre.Catch <- c(sum(tmp$Days.lt) * tmp$P.Days.ea[1] * pre.CpD, sum(tmp$Days.lt) * tmp$P.Days.ea[2] * tmp$CpD.lt[2])
pre.Value <- pre.Catch * tmp.val
obs.Value <- tmp$Catch.lt * tmp.val
tmp.dat <- data.frame(yy = tmp$yy, Status = tmp$Status, obs.Days = tmp$Days.lt, pre.Days, obs.Catch = tmp$Catch.lt, pre.Catch,
obs.Value, pre.Value)
if(dim(tmp)[1] < 2){
tmp.dat[, 3:dim(tmp.dat)[2]] <- NA
}
return(tmp.dat)
}
tmp.store <- lapply(yr.range[2]:yr.range[3], function(x) calc.stats(t = x))
tmp.store <- rbindlist(tmp.store) %>% mutate(val.diff = pre.Value - obs.Value,
Status1 = ifelse(Status == "Closure", "Closure - actual     ", "No closure - actual     "),
Status2 = ifelse(Status == "Closure", "Closure - predicted     ", "No closure - predicted     "))
means.store <- tmp.store %>% group_by(Status) %>%
summarise(yy = last.yr + 1, obs.Days = mean(obs.Days, na.rm = TRUE), pre.Days = mean(pre.Days, na.rm = TRUE),
obs.Catch = mean(obs.Catch, na.rm = TRUE),
pre.Catch = mean(pre.Catch, na.rm = TRUE),  obs.Value = mean(obs.Value, na.rm = TRUE),  pre.Value = mean(pre.Value, na.rm = TRUE),
val.diff = mean(val.diff, na.rm = TRUE), Status1 = unique(Status1), Status2 = unique(Status2))
tmp.store <- rbind(tmp.store, means.store)
windows(4500,3000)
pl <- ggplot() + geom_bar(data = tmp.store, aes(x = yy - 0.2, y = obs.Days, fill = Status1), stat = "identity", width = 0.4, colour = "black") +
geom_bar(data = tmp.store, aes(x = yy + 0.2, y = pre.Days, fill = Status2), stat = "identity", width = 0.4, colour = "black") +
xlab("") + ylab("Days fished") +
scale_x_continuous(breaks = yr.range[2]:(yr.range[3] + 1), labels = c(yr.range[2]:yr.range[3], "Average")) +
scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
scale_fill_manual(values = c("salmon3","lightsalmon","steelblue3","powderblue")) +
theme(legend.title = element_blank(), legend.key.size = unit(0.6, "cm"),
legend.text = element_text(size = 14), axis.title = element_text(size = 15),
axis.text = element_text(size = 15), legend.position = "top")
print(pl)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, "_Predicted_Days_Lost.png"), type = "png")
pl <- ggplot() + geom_bar(data = tmp.store, aes(x = yy - 0.2, y = obs.Catch, fill = Status1), stat = "identity", width = 0.4, colour = "black") +
geom_bar(data = tmp.store, aes(x = yy + 0.2, y = pre.Catch, fill = Status2), stat = "identity", width = 0.4, colour = "black") +
xlab("") + ylab("Catch (mt)") +
scale_x_continuous(breaks = yr.range[2]:(yr.range[3] + 1), labels = c(yr.range[2]:yr.range[3], "Average")) +
scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
scale_fill_manual(values = c("salmon3","lightsalmon","steelblue3","powderblue")) +
theme(legend.title = element_blank(), legend.key.size = unit(0.7, "cm"),
legend.text = element_text(size = 14), axis.title = element_text(size = 15),
axis.text = element_text(size = 15), legend.position = "top")
print(pl)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, "_Predicted_Catch_Lost.png"), type = "png")
pl <- ggplot() + geom_bar(data = tmp.store, aes(x = yy - 0.2, y = obs.Value/1000000, fill = Status1), stat = "identity", width = 0.4, colour = "black") +
geom_bar(data = tmp.store, aes(x = yy + 0.2, y = pre.Value/1000000, fill = Status2), stat = "identity", width = 0.4, colour = "black") +
xlab("") + ylab("Value (Millions $US)") +
scale_x_continuous(breaks = yr.range[2]:(yr.range[3] + 1), labels = c(yr.range[2]:yr.range[3], "Average")) +
scale_y_continuous(labels = function(x) format(x, big.mark = ",", scientific = FALSE)) +
scale_fill_manual(values = c("salmon3","lightsalmon","steelblue3","powderblue")) +
theme(legend.title = element_blank(), legend.key.size = unit(0.7, "cm"),
legend.text = element_text(size = 14), axis.title = element_text(size = 15),
axis.text = element_text(size = 15), legend.position = "top")
print(pl)
savePlot(paste0(base.dir, "Plots/", EZplot, "/", EZplot, "_Predicted_Value_Lost.png"), type = "png")
dev.off()
return(tmp.store)
}
# Not that in the lost value data frames I call the average over the period the current year (e.g. 2020) so that it is plotted correctly
# In the summary values in the report these values are removed so they don't influence the results
for.eez.lost.val <- lapply(keep.ez, function(x) predict_lost_value(dat = agdat, yr.range = c(2000,fst.yr,last.yr),
EZplot = x)); names(for.eez.lost.val) <- keep.ez
full.dat$for.eez.lost.val <- for.eez.lost.val
save(full.dat, file = paste0(base.dir, "Reports/All_Summary_Values.RData"))
15000*(1/.87)
15000*1/.87
15000*1/.87+(15000/.87*.055)
15000*1.1/.87+(15000/.87*.055)
15000*(1.1/.87)+(15000/.87*.055)
15000*(1.15/.87)+(15000/.87*.055)
3/137
30*4.24
30*5.09
142930+1146/.92+64307+32910/.92+10000
