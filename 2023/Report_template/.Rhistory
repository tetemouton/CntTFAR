lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
lat = ifelse(lat_hem == "S", -lat, lat) + 2.5, lon = ifelse(lon_hem == "W", 360 - lon, lon) + 2.5)
table(dat_sh$lon, dat_sh$lond)
dat_sh <- dat %>% filter(yy >= 2000) %>% mutate(lat = as.numeric(str_sub(lat, end = -2)), lon = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -lat, lat) + 2.5, lond = ifelse(lon_hem == "W", 360 - lon, lon) + 2.5)
table(dat_sh$lon, dat_sh$lond)
head(dat)
dat_sh <- dat %>% filter(yy >= 2000) %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5)
head(dat)
table(dat_sh$lon, dat_sh$lond)
tmp=table(dat_sh$lon, dat_sh$lond)
view(tmp)
tail(table(dat_sh$lon, dat_sh$lond))
head(dat_sh)
dat_ck <- sqlQuery(myConn, "SELECT
lt.log_trip_id,
lv.vessel_id,
lv.vessel_instance_id,
lv.vesselname,
lv.vesselname_normalised,
lv.old_vessel_id,
lv.flag_id,
lv.flag_rg_id,
lt.depart_date,
ls.LOG_SET_ID,
ls.logdate,
day(ls.logdate) AS dy,
month(ls.logdate) AS mon,
year(ls.logdate) AS yr,
ls.lat,
ls.lon,
ref.getlatdfromlat(ls.lat) as latd,
ref.getlondfromlon(ls.lon) as lond,
ls.l_activity_id,
ls.eez_code,
ls.set_no,
ls.hook,
ls.hk_bt_flt_n,
lc.SP_CODE,
lc.SP_N,
lc.SP_KG
FROM	log.trips_ll lt
left outer join log.sets_ll ls on  lt.log_trip_id = ls.LOG_TRIP_ID
left outer join log.catch_ll lc on  ls.LOG_SET_ID = lc.LOG_SET_ID
inner join ref.vessel_instances lv on lt.vessel_id = lv.old_vessel_id
WHERE ls.eez_code IN ('CK')",
stringsAsFactors = FALSE)
dim(dat_ck)
dat_ck <- sqlQuery(myConn, "SELECT
lt.log_trip_id,
lv.vessel_id,
lv.vessel_instance_id,
lv.vesselname,
lv.vesselname_normalised,
lv.old_vessel_id,
lv.flag_id,
lv.flag_rg_id,
lt.depart_date,
ls.LOG_SET_ID,
ls.logdate,
day(ls.logdate) AS dy,
month(ls.logdate) AS mon,
year(ls.logdate) AS yr,
ls.lat,
ls.lon,
ref.getlatdfromlat(ls.lat) as latd,
ref.getlondfromlon(ls.lon) as lond,
ls.l_activity_id,
ls.eez_code,
ls.set_no,
ls.hook,
ls.hk_bt_flt_n,
lc.SP_CODE,
lc.SP_N,
lc.SP_KG
FROM	log.trips_ll lt
left outer join log.sets_ll ls on  lt.log_trip_id = ls.LOG_TRIP_ID
left outer join log.catch_ll lc on  ls.LOG_SET_ID = lc.LOG_SET_ID
inner join ref.vessel_instances lv on lt.vessel_id = lv.old_vessel_id
WHERE ls.eez_code = 'CK'",
stringsAsFactors = FALSE)
dim(dat_ck)
save(dat_ck, file = paste0(dat_pth, "LS_Dat_Cooks.RData"))
head(dat_sh)
windows()
plot(dat_sh$lond,dat_sh$latd)
dat_sh <- dat %>% filter(yy >= 2000) %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5) %>%
filter(latd < 10, latd > 30, lond > 140, lond < 230)
plot(dat_sh$lond,dat_sh$latd)
head(dat_sh)
dat_sh <- dat %>% filter(yy >= 2000) %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5)
head(dat_sh)
table(dat_sh$lond)
dat_sh <- dat %>% filter(yy >= 2000) %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5) %>%
filter(latd < -10, latd > -30, lond > 140, lond < 230)
plot(dat_sh$lond,dat_sh$latd)
table(dat_sh$flag_id)
table(dat_sh$fleet_id)
head(dat_sh)
31/26
dat_pi <- dat_sh %>% filter(flag_id %in% c("CK","FJ","NC","PF","SB","TO","VU","WS"))
head(dat_pi)
table(dat_pi$ocean_id)
dat_pi_pl <- dat_pi %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks)
dat_pi_pl
dat_pi_pl <- dat_pi %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
dat_pi_pl
windows(4000,400000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() +
facet_wrap(~Flag)
windows(4000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() +
facet_wrap(~Flag)
print(pl)
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() +
facet_wrap(~Flag)
print(pl)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line()
facet_wrap(~Flag)
print(pl)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~Flag)
print(pl)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y")
print(pl)
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag)
print(pl)
head(dat_pi)
head(dat_pi_pl)
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = Hooks)) + geom_bar(stat = "identity") +
facet_wrap(~ Flag)
print(pl)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = Hooks)) + geom_bar(stat = "identity", width = .8, fill = alpha("steelblue",.7)) +
facet_wrap(~ Flag)
print(pl)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = Hooks)) + geom_bar(stat = "identity", width = .75, fill = alpha("steelblue",.7)) +
facet_wrap(~ Flag)
print(pl)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = Hooks/1000)) + geom_bar(stat = "identity", width = .75, fill = alpha("steelblue",.7)) +
facet_wrap(~ Flag)
print(pl)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = Hooks/10000)) + geom_bar(stat = "identity", width = .75, fill = alpha("steelblue",.7)) +
facet_wrap(~ Flag)
print(pl)
table(dat_sh$flag_id)
dat_pi <- dat_sh %>% filter(flag_id %in% c("CN","JP","KR","TW","US"))
dat_pi_pl <- dat_pi %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag)
print(pl)
dat_sh <- dat %>% filter(yy >= 1990) %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5) %>%
filter(latd < -10, latd > -30, lond > 140, lond < 230)
dat_sh <- dat %>% filter(yy >= 1990) %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5) %>%
filter(latd < -10, latd > -30, lond > 140, lond < 230)
dat_pi <- dat_sh %>% filter(flag_id %in% c("CK","FJ","NC","PF","SB","TO","VU","WS"))
dat_pi_pl <- dat_pi %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y")
print(pl)
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag)
print(pl)
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = Hooks/10000)) + geom_bar(stat = "identity", width = .75, fill = alpha("steelblue",.7)) +
facet_wrap(~ Flag)
print(pl)
dat_dw <- dat_sh %>% filter(flag_id %in% c("CN","JP","KR","TW","US"))
dat_dw_pl <- dat_dw %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(dat_dw_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y")
print(pl)
windows(6000,4000)
pl <- ggplot(dat_dw_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag)
print(pl)
windows(6000,4000)
pl <- ggplot(dat_dw_pl, aes(x = Year, y = Hooks/10000)) + geom_bar(stat = "identity", width = .75, fill = alpha("steelblue",.7)) +
facet_wrap(~ Flag)
print(pl)
50200*.185
50200*.21
50200*.25
50200*.27
50200*.29
50200*.31
dat <- read.csv(file = paste0(dir_pth, "/Data/Ann_LL_Cat_Effort_Flg_5x5_AllOceans.csv"), header = TRUE)
dat_sh <- dat %>% filter(yy >= 1990) %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5) %>%
filter(latd < -10, latd > -30, lond > 140, lond < 230)
dat_pi <- dat_sh %>% filter(flag_id %in% c("CK","FJ","NC","PF","SB","TO","VU","WS"))
dat_pi_pl <- dat_pi %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y")
print(pl)
dat <- read.csv(file = paste0(dir_pth, "/Data/Ann_LL_Cat_Effort_Flg_5x5_AllOceans.csv"), header = TRUE)
dat_sh <- dat %>% filter(yy >= 1990) %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5) %>%
filter(latd < -10, latd > -30, lond > 140, lond < 230)
dat_pi <- dat_sh %>% filter(flag_id %in% c("CK","FJ","NC","PF","SB","TO","VU","WS"))
dat_pi_pl <- dat_pi %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y")
print(pl)
savePlot(paste0(dir.pth, "/Output/CPUE_Nos-per-hhook_domestic_freey.png"), type="png")
dat <- read.csv(file = paste0(dir_pth, "/Data/Ann_LL_Cat_Effort_Flg_5x5_AllOceans.csv"), header = TRUE)
dat_sh <- dat %>% filter(yy >= 1990) %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5) %>%
filter(latd < -10, latd > -30, lond > 140, lond < 230)
dat_pi <- dat_sh %>% filter(flag_id %in% c("CK","FJ","NC","PF","SB","TO","VU","WS"))
dat_pi_pl <- dat_pi %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y")
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_Nos-per-hhook_domestic_freey.png"), type="png")
dev.off()
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag)
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_Nos-per-hhook_domestic.png"), type="png")
dev.off()
windows(6000,4000)
pl <- ggplot(dat_pi_pl, aes(x = Year, y = Hooks/10000)) + geom_bar(stat = "identity", width = .75, fill = alpha("steelblue",.7)) +
facet_wrap(~ Flag)
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_TotalHooks_domestic.png"), type="png")
dev.off()
dat_dw <- dat_sh %>% filter(flag_id %in% c("CN","JP","KR","TW","US"))
dat_dw_pl <- dat_dw %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(dat_dw_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y")
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_Nos-per-hhook_distant-water_freey.png"), type="png")
dev.off()
windows(6000,4000)
pl <- ggplot(dat_dw_pl, aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag)
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_Nos-per-hhook_distant-water.png"), type="png")
dev.off()
windows(6000,4000)
pl <- ggplot(dat_dw_pl, aes(x = Year, y = Hooks/10000)) + geom_bar(stat = "identity", width = .75, fill = alpha("steelblue", .7)) +
facet_wrap(~ Flag)
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_TotalHooks_distant-water.png"), type="png")
dev.off()
dat <- read.csv(file = paste0(dir_pth, "/Data/Ann_LL_Cat_Effort_Flg_5x5_AllOceans.csv"), header = TRUE)
dat_sh <- dat %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5) %>%
filter(latd < -10, latd > -30, lond > 140, lond < 230)
# Domestic flags
dat_pi <- dat_sh %>% filter(flag_id %in% c("CK","FJ","NC","PF","SB","TO","VU","WS"))
dat_pi_pl <- dat_pi %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(filter(dat_pi_pl, yy > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y")
dat <- read.csv(file = paste0(dir_pth, "/Data/Ann_LL_Cat_Effort_Flg_5x5_AllOceans.csv"), header = TRUE)
dat_sh <- dat %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5) %>%
filter(latd < -10, latd > -30, lond > 140, lond < 230)
# Domestic flags
dat_pi <- dat_sh %>% filter(flag_id %in% c("CK","FJ","NC","PF","SB","TO","VU","WS"))
dat_pi_pl <- dat_pi %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y")
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_Nos-per-hhook_domestic_freey.png"), type="png")
dev.off()
windows(6000,4000)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag)
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_Nos-per-hhook_domestic.png"), type="png")
dev.off()
windows(6000,4000)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = Hooks/10000)) + geom_bar(stat = "identity", width = .75, fill = alpha("steelblue",.7)) +
facet_wrap(~ Flag)
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_TotalHooks_domestic.png"), type="png")
dev.off()
# Distant water flags
dat_dw <- dat_sh %>% filter(flag_id %in% c("CN","JP","KR","TW","US"))
dat_dw_pl <- dat_dw %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(filter(dat_dw_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y")
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_Nos-per-hhook_distant-water_freey.png"), type="png")
dev.off()
windows(6000,4000)
pl <- ggplot(filter(dat_dw_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag)
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_Nos-per-hhook_distant-water.png"), type="png")
dev.off()
windows(6000,4000)
pl <- ggplot(filter(dat_dw_pl, Year > 2000), aes(x = Year, y = Hooks/10000)) + geom_bar(stat = "identity", width = .75, fill = alpha("steelblue", .7)) +
facet_wrap(~ Flag)
print(pl)
savePlot(paste0(dir_pth, "/Output/CPUE_TotalHooks_distant-water.png"), type="png")
dev.off()
windows(6000,4000)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y") + geom_rect(aes(xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf)) +
geom_rect(aes(xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf)) + geom_rect(aes(xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf))
print(pl)
windows(6000,4000)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y") + geom_rect(aes(xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf), fill = alpha("blue",.2)) +
geom_rect(aes(xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf), fill = alpha("blue",.2)) +
geom_rect(aes(xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf), fill = alpha("blue",.2))
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y") + geom_rect(aes(xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf), fill = alpha("blue",.02)) +
geom_rect(aes(xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf), fill = alpha("green",.02)) +
geom_rect(aes(xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf), fill = alpha("red",.02))
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 5) + geom_line(linewidth = 2) +
facet_wrap(~ Flag, scales = "free_y") + geom_rect(aes(xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf), fill = alpha("blue",.01)) +
geom_rect(aes(xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf), fill = alpha("green",.02)) +
geom_rect(aes(xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf), fill = alpha("red",.02)) + geom_point(size = 5) + geom_line(linewidth = 2) +
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 5) + geom_line(linewidth = 2) +
facet_wrap(~ Flag, scales = "free_y") + geom_rect(aes(xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf), fill = alpha("blue",.01)) +
geom_rect(aes(xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf), fill = alpha("green",.02)) +
geom_rect(aes(xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf), fill = alpha("red",.02)) + geom_point(size = 5) + geom_line(linewidth = 2)
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") + geom_rect(aes(xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf), fill = alpha("blue",.01)) +
geom_rect(aes(xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf), fill = alpha("green",.02)) +
geom_rect(aes(xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf), fill = alpha("red",.02)) + geom_point(size = 5) + geom_line(linewidth = 2)
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") + geom_rect(aes(xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf), fill = alpha("blue",.01)) +
geom_rect(aes(xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf), fill = alpha("green",.02)) +
geom_rect(aes(xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf), fill = alpha("red",.02)) + geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
1700*65
82300+15600
62500+15600
51300+15600
47800+15600
.24/.184
146000*.185
146000*.24
146000*.27
146000*.29
.89/.85
.92/.85
65000+15600
.8*72500
.8*72200
57800+15600
.53/.68
57800/47800
.3/.24
41626*.06
.5/.495
.19/.185
.19/.185*6000
6000/.185
6000/.18
library(tidyverse)
library(magrittr)
theme_set(theme_bw())
dir_pth <- "C:/South_Pacific_Albacore/Premoc23/ALB_cpue/"
lastyr <- 2023
#____________________________________________________________________________________________________________
dat <- read.csv(file = paste0(dir_pth, "/Data/Ann_LL_Cat_Effort_Flg_5x5_AllOceans.csv"), header = TRUE)
dat_sh <- dat %>% mutate(latd = as.numeric(str_sub(lat, end = -2)), lond = as.numeric(str_sub(lon, end = -2)),
lat_hem = str_sub(lat, start = -1), lon_hem = str_sub(lon, start = -1),
latd = ifelse(lat_hem == "S", -latd, latd) + 2.5, lond = ifelse(lon_hem == "W", 360 - lond, lond) + 2.5) %>%
filter(latd < -10, latd > -30, lond > 140, lond < 230)
# Domestic flags
dat_pi <- dat_sh %>% filter(flag_id %in% c("CK","FJ","NC","PF","SB","TO","VU","WS"))
dat_pi_pl <- dat_pi %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = inf, fill = "blue", colour = "black", alpha = 0.5) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = inf, fill = "green", colour = "black", alpha = 0.5) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = inf, fill = "red", colour = "black", alpha = 0.5) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = NA, fill = "blue", colour = "black", alpha = 0.5) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = NA, fill = "green", colour = "black", alpha = 0.5) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = NA, fill = "red", colour = "black", alpha = 0.5) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = 2, fill = "blue", colour = "black", alpha = 0.5) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = 2, fill = "green", colour = "black", alpha = 0.5) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = 2, fill = "red", colour = "black", alpha = 0.5) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = 2, fill = "blue", alpha = 0.5) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = 2, fill = "green", alpha = 0.5) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = 2, fill = "red", alpha = 0.5) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf, fill = "blue", alpha = 0.5) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = 2, fill = "green", alpha = 0.5) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = 2, fill = "red", alpha = 0.5) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf, fill = "blue", alpha = 0.5) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf, fill = "green", alpha = 0.5) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf, fill = "red", alpha = 0.5) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf, fill = "blue", alpha = 0.2) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf, fill = "green", alpha = 0.2) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf, fill = "red", alpha = 0.2) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf, fill = "blue", alpha = 0.3) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf, fill = "green", alpha = 0.3) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf, fill = "red", alpha = 0.3) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point(size = 3) + geom_line(linewidth = 1.2) +
facet_wrap(~ Flag, scales = "free_y") +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf, fill = "blue", alpha = 0.4) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf, fill = "green", alpha = 0.4) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf, fill = "red", alpha = 0.4) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
windows(6000,4000)
pl <- ggplot(filter(dat_pi_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag) +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf, fill = "blue", alpha = 0.4) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf, fill = "green", alpha = 0.4) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf, fill = "red", alpha = 0.4) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
dat_dw <- dat_sh %>% filter(flag_id %in% c("CN","JP","KR","TW","US"))
dat_dw_pl <- dat_dw %>% group_by(Year = yy, Flag = flag_id) %>% summarise(Hooks = sum(hhooks), albN = sum(alb_no), albC = sum(alb_c)) %>%
mutate(cpue_n = albN/Hooks, cpue_c = albC/Hooks*1000) # Convert catch at weight to kilos, and note that hooks = 100's of hooks
windows(6000,4000)
pl <- ggplot(filter(dat_dw_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag, scales = "free_y") +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf, fill = "blue", alpha = 0.4) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf, fill = "green", alpha = 0.4) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf, fill = "red", alpha = 0.4) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
pl <- ggplot(filter(dat_dw_pl, Year > 2000), aes(x = Year, y = cpue_n)) + geom_point() + geom_line() +
facet_wrap(~ Flag) +
annotate(geom = "rect", xmin = 2016.5, xmax = 2019.5, ymin = 0, ymax = Inf, fill = "blue", alpha = 0.4) +
annotate(geom = "rect", xmin = 2014.5, xmax = 2018.5, ymin = 0, ymax = Inf, fill = "green", alpha = 0.4) +
annotate(geom = "rect", xmin = 2012.5, xmax = 2013.5, ymin = 0, ymax = Inf, fill = "red", alpha = 0.4) +
geom_point(size = 3) + geom_line(linewidth = 1.2)
print(pl)
10^(1/40)
1.0593^40
